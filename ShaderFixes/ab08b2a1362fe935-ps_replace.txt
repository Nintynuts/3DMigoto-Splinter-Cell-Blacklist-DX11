// God Rays Downsample (2)

cbuffer CB_PS_Downsample16x16 : register(b7)
{
	float4 cTexelSizeDownsample : packoffset(c0);
}

SamplerState sTex_s : register(s0);
Texture2D<float4> sTex : register(t0);

#include "3Dmigoto.hlsl"

void main(
	float4 v0 : SV_Position0,
	out float4 o0 : SV_Target0)
{
	float4 r0,r1,r2;

	r0.xy = v0.xy * cTexelSizeDownsample.xy + -cTexelSizeDownsample.zw;
	r0 = sTex.Sample(sTex_s, r0.xy);
	r1.xy = v0.xy * cTexelSizeDownsample.xy + cTexelSizeDownsample.zw;
	r1 = sTex.Sample(sTex_s, r1.xy);
	r0 = r1 + r0;
	r1.xy = cTexelSizeDownsample.xy * v0.xy;
	r1 = cTexelSizeDownsample.zwzw * float4(-1,1,1,-1) + r1.xyxy;
	r2 = sTex.Sample(sTex_s, r1.xy);
	r1 = sTex.Sample(sTex_s, r1.zw);
	r0 = r2 + r0;
	r0 = r0 + r1;
	o0 = 0.25 * r0;
	return;
}